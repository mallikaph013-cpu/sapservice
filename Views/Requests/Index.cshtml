@model IEnumerable<myapp.Models.RequestItem>

@{
    ViewData["Title"] = "Service Requests";

    // Helper to get status badge color class
    Func<string, string> GetStatusClass = (status) => {
        switch (status?.ToLower()) {
            case "approved": return "status-approved";
            case "rejected": return "status-rejected";
            case "processing": return "status-processing";
            default: return "status-pending";
        }
    };
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="mb-0">Service Requests</h1>
    <a asp-action="Create" class="btn btn-primary">Create New Request</a>
</div>

@if (Model.Any())
{
    <div class="request-card-grid">
        @foreach (var item in Model)
        {
            <div class="request-card">
                <div class="request-card-header">
                    <div>
                        <p class="request-card-title">@Html.DisplayFor(modelItem => item.RequestType) Request</p>
                        <p class="request-card-requester">by @Html.DisplayFor(modelItem => item.Requester)</p>
                    </div>
                    <span class="request-status @GetStatusClass(item.Status)">@Html.DisplayFor(modelItem => item.Status)</span>
                </div>

                <div class="request-card-body">
                    <p>
                        <strong>Description:</strong>
                        <span>@Html.DisplayFor(modelItem => item.Description)</span>
                    </p>
                    <p>
                        <strong>Date:</strong>
                        <span>@item.RequestDate.ToString("MMM dd, yyyy")</span>
                    </p>
                </div>

                <div class="request-card-footer">
                    <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-sm btn-secondary">Details</a>
                    <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-primary">Edit</a>
                </div>
            </div>
        }
    </div>
}
else
{
    <div class="text-center main-content-card">
        <h4 class="text-dark">No requests found.</h4>
        <p class="text-light">Get started by creating a new service request.</p>
        <a asp-action="Create" class="btn btn-primary mt-3">Create Your First Request</a>
    </div>
}
